
USE SID_DEV
GO


DECLARE @fg varchar(50)
DECLARE @ind int=0
DECLARE @cmd varchar(max)

 ------création des FG

While @ind < 25
BEGIN
set @ind=@ind+1
set @cmd = 'ALTER DATABASE [SID_DEV] ADD FILEGROUP [FG_SID_DEV_2_ODS_DATE_'+replicate ('0', 2-len (@ind))+cast(@ind as varchar)+']'
exec(@cmd)
END

 ------création des Fichiers

set @ind=0
While @ind < 25
BEGIN
set @ind=@ind+1
set @cmd = 'ALTER DATABASE [SID_DEV] ADD FILE ( NAME = N''FG_SID_DEV_2_ODS_DATE_'+replicate ('0', 2-len (@ind))+cast(@ind as varchar)+''', 
FILENAME = N''D:\DATA\SID_DEV_2\FG\FG_SID_DEV_2_ODS_DATE_'+replicate ('0', 2-len (@ind))+cast(@ind as varchar)+'.ndf'' , SIZE = 5120KB , FILEGROWTH = 1024KB ) 
TO FILEGROUP [FG_SID_DEV_2_ODS_DATE_'+replicate ('0', 2-len (@ind))+cast(@ind as varchar)+']'      
exec(@cmd)
END

-- Create partition function and scheme
CREATE PARTITION FUNCTION [FCT_SID_DEV_ODS_DATE] (date)
AS RANGE LEFT FOR VALUES ('20121231','20131231','20141231','20151231','20161231','20170131','20170228', '20170331','20170430'
,'20170531','20170630','20170731','20170831', '20170930','20171031','20171130','20171231','20180131','20180228', '20180331'
,'20180430','20180531','20180630','20180731')
GO
--CREATE PARTITION SCHEME myPartitionScheme AS PARTITION myDateRangePF ALL TO ([PRIMARY]) 
--GO 
CREATE PARTITION SCHEME [SCH_SID_DEV_ODS_DATE] AS PARTITION [FCT_SID_DEV_ODS_DATE] TO (
'FG_SID_DEV_2_ODS_DATE_01','FG_SID_DEV_2_ODS_DATE_02','FG_SID_DEV_2_ODS_DATE_03','FG_SID_DEV_2_ODS_DATE_04','FG_SID_DEV_2_ODS_DATE_05','FG_SID_DEV_2_ODS_DATE_06',
'FG_SID_DEV_2_ODS_DATE_07','FG_SID_DEV_2_ODS_DATE_08','FG_SID_DEV_2_ODS_DATE_09','FG_SID_DEV_2_ODS_DATE_10','FG_SID_DEV_2_ODS_DATE_11','FG_SID_DEV_2_ODS_DATE_12','FG_SID_DEV_2_ODS_DATE_13',
'FG_SID_DEV_2_ODS_DATE_14','FG_SID_DEV_2_ODS_DATE_15','FG_SID_DEV_2_ODS_DATE_16','FG_SID_DEV_2_ODS_DATE_17','FG_SID_DEV_2_ODS_DATE_18','FG_SID_DEV_2_ODS_DATE_19','FG_SID_DEV_2_ODS_DATE_20',
'FG_SID_DEV_2_ODS_DATE_21','FG_SID_DEV_2_ODS_DATE_22','FG_SID_DEV_2_ODS_DATE_23','FG_SID_DEV_2_ODS_DATE_24','FG_SID_DEV_2_ODS_DATE_25')
